# PowerShell-SharePoint
This script automates the duplication of a Microsoft Team for testing. **Key Features:** 1. **Team Creation:** Creates a new team using `New-Team` with a `Test-` prefix appended to the original name. 2. **User Migration:** Iterates through the source team's users (`Get-TeamUser`) and adds them to the new team with their respective roles (Owner/Member). 3. **Channel Replication:** Copies both Standard and Private channels. Note: Creating a Private channel generally requires the script runner to be an owner, which is handled implicitly if the creator is the admin. 4. **SharePoint Content Copy:** - It resolves the underlying SharePoint Site URLs using `Get-UnifiedGroup`. - It uses `Connect-PnPOnline` to connect to the source site. - It utilizes `Copy-PnPFile` to perform a cross-site copy of folders within 'Shared Documents' (which map to Channels) to the new Target site. 5. **Logging & Error Handling:** Includes a custom `Write-Log` function for color-coded status updates and `Try-Catch` blocks to ensure the script fails gracefully or reports specific errors without crashing entirely.